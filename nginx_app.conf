location / {
# try to serve file directly, fallback to rewrite
try_files $uri /index.php$query_string;
}

location ~ ^/index\.php(/|$) {
    try_files @heroku-fcgi @heroku-fcgi;
}

   # PHP FPM configuration.
location ~* \.php$ {

     # After practise, I found reflight response must response CORS headers too !
     if ($request_method = 'OPTIONS') {
         add_header 'Access-Control-Max-Age' 86400;
         add_header 'Access-Control-Allow-Origin' "$http_origin" always;
         add_header 'Access-Control-Allow-Credentials' 'true' always;
         add_header 'Access-Control-Allow-Methods' 'GET, POST, PUT, DELETE, OPTIONS' always;
         add_header 'Access-Control-Allow-Headers' 'Accept, Authorization, Cache-Control, Content-Type, Keep-Alive, Origin, User-Agent, X-Requested-With';
         add_header 'Access-Control-Expose-Headers' 'Authorization, X-RateLimit-Limit, X-RateLimit-Remaining, X-RateLimit-Reset' always;
         return 204;
     }
}
